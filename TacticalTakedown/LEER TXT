// TXT.cpp : Este archivo contiene la función "main". La ejecución del programa comienza y termina ahí.
//

#include <iostream>
#include "fstream"
#include "string"
#pragma warning(disable:4996)
int** leerMatrices(const char* fileName);

using namespace std;

#define ESCALA 5 //escala de texturas
#define  MAX 100
#define  MAX_FIL 50 //cambiar si aumenta el tamaño de las matrices
#define  MAX_COL 50 

int main()
{
	int** matrix = NULL;
	matrix = leerMatrices("output.txt");
	cout <<"LA MATRIZ ES:  "<<endl;
	for (int i = 0; i <= 28; i++) {
		for (int j = 0; j <=19; j++)
		{
			cout << matrix[i][j] << " ";
		}
		cout << endl;

	}

}
int** leerMatrices(const char* fileName) {
	char cadena[MAX];
	bool flag_inicio = 0;
	int num = 0;
	int j = 0;
	int k = 0;
	int cifra = 0;
	int flag_num = 0;
	int MATRIZ[MAX_COL][MAX_FIL];
	FILE* entrada;
	int COLS = 0;
	int FILS = 0;
	int** matrix = NULL;//punto a matriz

	entrada = fopen(fileName, "r");
	if (entrada == NULL)
		printf("NO SE PUEDE ABRIR");
	else
	{
		fgets(cadena, 10, entrada);
		for (int n = 0; n < 2; n++) {
			if ((cadena[n] >= '0') && (cadena[n] <= '9')) {
				cifra = cadena[n] - 48; //char a int
				COLS = COLS * 10 + cifra;
			}

		}
		fgets(cadena, 10, entrada);

		for (int u = 0; u < 2; u++) {
			if ((cadena[u] >= '0') && (cadena[u] <= '9')) {

				cifra = cadena[u] - 48; //char a int
				FILS = FILS * 10 + cifra;
				//cout << FILS << endl;
			}
		}
		j = k = 0;
		while (!feof(entrada))
		{

			fgets(cadena, MAX, entrada);
			for (int i = 0; i < MAX; i++) {
				if (j <= FILS && k <= COLS)
				{

					if (cadena[i] == '{')
					{
						flag_inicio = 1;
						k = 0;
					}
					if ((cadena[i] >= '0') && (cadena[i] <= '9') && (flag_inicio == 1))
					{
						cifra = cadena[i] - 48; //char a int
						num = num * 10 + cifra;
						MATRIZ[j][k] =num;

					}
					else if ((cadena[i] == ',') && (flag_inicio == 1)) {
						k++;
						num = 0;


					}
					else if ((cadena[i] == '}') && (flag_inicio == 1)) {
						j++;
						k = num = 0;
						flag_inicio = 0;
						
					}
					else
					{

						num = 0;

					}
				}

			}
		}
		fclose(entrada);
		int** matriz = new int* [FILS];//PASAMOS LA MATRIZ POR PUNTEROS 
		for (int i = 0; i <=FILS; i++) {
			matriz[i] = new int[COLS];
			for (int j = 0; j <= COLS; j++) {
				cout<< MATRIZ[i][j]<<" ";
				matriz[i][j] = MATRIZ[i][j];
			}
			cout << endl;
		}
		return matriz;
	}
}
